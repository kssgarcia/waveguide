%---
% decomposition of the dft matrix for N=8
%---

N=8;
o = exp(2*pi*i/N);
o2=o*o;
o3=o2*o;
o4=o3*o;
o5=o4*o;
o6=o5*o;
o7=o6*o;

D1=eye(N);
D1(1,5)=1.0;
D1(2,6)=1.0;
D1(3,7)=1.0;
D1(4,8)=1.0;
D1(5,1)=1.0;
D1(6,2)=1.0;
D1(7,3)=1.0;
D1(8,4)=1.0;
D1(5,5)=o4;
D1(6,6)=o4;
D1(7,7)=o4;
D1(8,8)=o4;

D2=zeros(N);
D2(1,1)=1.0; D2(1,3)=1.0;
D2(2,2)=1.0; D2(2,4)=1.0;
D2(3,5)=1.0; D2(3,7)=o2;
D2(4,6)=1.0; D2(4,8)=o2;
D2(5,1)=1.0; D2(5,3)=o4;
D2(6,2)=1.0; D2(6,4)=o4;
D2(7,5)=1.0; D2(7,7)=o6;
D2(8,6)=1.0; D2(8,8)=o6;

D3=zeros(N);
D3(1,1)=1.0; D3(1,2)=1.0;
D3(2,3)=1.0; D3(2,4)=o;
D3(3,5)=1.0; D3(3,6)=o^2;
D3(4,7)=1.0; D3(4,8)=o^3;

D3(5,1)=1.0; D3(5,2)=o^4;
D3(6,3)=1.0; D3(6,4)=o^5;
D3(7,5)=1.0; D3(7,6)=o^6;
D3(8,7)=1.0; D3(8,8)=o^7;

sss = D3*D2*D1;

dft=[
  1 1 1 1 1 1 1 1;
  1 o^(01) o^(02) o^(03) o^(04) o^(05) o^(06) o^(07);
  1 o^(02) o^(04) o^(06) o^(08) o^(10) o^(12) o^(14);
  1 o^(03) o^(06) o^(09) o^(12) o^(15) o^(18) o^(21);
  1 o^(04) o^(08) o^(12) o^(16) o^(20) o^(24) o^(28);
  1 o^(05) o^(10) o^(15) o^(20) o^(25) o^(30) o^(35);
  1 o^(06) o^(12) o^(18) o^(24) o^(30) o^(36) o^(42);
  1 o^(07) o^(14) o^(21) o^(28) o^(35) o^(42) o^(49);
];

sss-dft
