clear all

%---
% driver for the doubly periodic Green's function
%---

a11 = 1.0;
a12 = 0.0;
a21 = 0.0;
a22 = 1.0;

[ew,cellarea,b11,b12,b21,b22] = lgf_3d_2p_ewald ...
     ...
     (a11,a12 ...
     ,a21,a22 ...
     );

method = 2;
Max1 = 4;
Max2 = 4;
Max3 = 4;

x0=0;
y0=0;
z0=0;

x=0.001;
y=0.001;
z=0.001;

Iopt = 2;

   [G,Gx,Gy,Gz] = lgf_3d_2p ...
     ...
       (Iopt ...
       ,method ...
       ,x,y,z ...
       ,x0,y0,z0 ...
       ,a11,a12,a21,a22 ...
       ,b11,b12,b21,b22 ...
       ,ew,cellarea ...
       ,Max1,Max2,Max3 ...
       );

    [Gfs,Gfsx,Gfsy,Gfsz] = lgf_3d_fs ...
        ...
       (x,y,z ...
       ,x0,y0,z0 ...
       ,Iopt);

[G-Gfs]

